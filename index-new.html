<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>KRA POST PORTUM TOOL</title>
    <link rel="stylesheet" href="styles-new.css" />
    <link rel="stylesheet" href="toast-styles.css" />
    <link rel="stylesheet" href="automation-table-styles.css" />
  </head>
  <body>
    <div class="app-container">
      <!-- Sidebar Navigation -->
      <aside class="sidebar">
        <div class="sidebar-header">
          <div class="logo">
            <svg width="28" height="28" viewBox="0 0 32 32" fill="none">
              <rect width="32" height="32" rx="8" fill="#667eea" />
              <path d="M10 16L14 20L22 12" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            <span>POST PORTUM</span>
          </div>
        </div>

        <nav class="sidebar-nav">
          <div class="nav-section">
            <div class="nav-section-title">SETUP</div>
            <button class="nav-item active" data-tab="company-setup">
              <span class="nav-icon">üè¢</span> <span class="nav-label">Company Setup</span>
            </button>
            <button class="nav-item" data-tab="password-validation">
              <span class="nav-icon">üîê</span> <span class="nav-label">Validation</span>
            </button>
          </div>

          <div class="nav-section">
            <div class="nav-section-title">OVERVIEW</div>
            <button class="nav-item" data-tab="full-profile">
              <span class="nav-icon">üìä</span> <span class="nav-label">Full Profile</span> <span class="nav-badge">New</span>
            </button>
          </div>

          <div class="nav-section">
            <div class="nav-section-title">EXTRACTIONS</div>
            <button class="nav-item" data-tab="manufacturer-details">
              <span class="nav-icon">üìã</span> <span class="nav-label">Manufacturer Details</span>
            </button>
            <button class="nav-item" data-tab="director-details">
              <span class="nav-icon">üëî</span> <span class="nav-label">Director Details</span>
            </button>
            <button class="nav-item" data-tab="obligation-checker">
              <span class="nav-icon">üìù</span> <span class="nav-label">Obligations</span>
            </button>
            <button class="nav-item" data-tab="agent-checker">
              <span class="nav-icon">üîç</span> <span class="nav-label">Agent Status</span>
            </button>
            <button class="nav-item" data-tab="liabilities">
              <span class="nav-icon">üí∞</span> <span class="nav-label">Liabilities</span>
            </button>
            <button class="nav-item" data-tab="vat-returns">
              <span class="nav-icon">üìä</span> <span class="nav-label">VAT Returns</span>
            </button>
            <button class="nav-item" data-tab="wh-vat-returns">
              <span class="nav-icon">üßæ</span> <span class="nav-label">WH VAT Returns</span>
            </button>
            <button class="nav-item" data-tab="general-ledger">
              <span class="nav-icon">üìñ</span> <span class="nav-label">General Ledger</span>
            </button>
            <button class="nav-item" data-tab="tax-compliance">
              <span class="nav-icon">‚úÖ</span> <span class="nav-label">Tax Compliance</span>
            </button>
          </div>

          <div class="nav-section">
            <div class="nav-section-title">AUTOMATION</div>
            <button class="nav-item" data-tab="all-automations">
              <span class="nav-icon">‚ö°</span> <span class="nav-label">Run All</span>
            </button>
          </div>
        </nav>

        <div class="sidebar-footer">
          <div class="folder-location">
            <div class="folder-info">
              <span class="folder-icon">üìÅ</span>
              <div class="folder-text">
                <div class="folder-label">Output Folder</div>
                <div id="sidebarFolderPath" class="folder-path">Not set</div>
              </div>
            </div>
            <button id="openFolderBtn" class="folder-open-btn" title="Open folder location">
              <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                <path
                  d="M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5L14 4.5zM9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5h-2.5A1 1 0 0 1 9.5 3z"
                />
              </svg>
            </button>
          </div>
          <button id="settingsBtn" class="settings-btn"><span>‚öôÔ∏è</span> <span>Settings</span></button>
        </div>
      </aside>

      <!-- Toast Container -->
      <div id="toastContainer" class="toast-container"></div>

      <!-- Settings Modal -->
      <div id="settingsModal" class="modal hidden">
        <div class="modal-content">
          <div class="modal-header">
            <h2>‚öôÔ∏è Settings</h2>
            <button class="modal-close" id="closeSettingsModal">√ó</button>
          </div>
          <div class="modal-body">
            <div class="settings-section">
              <h3>Output Folder</h3>
              <p class="settings-description">Choose where exported files will be saved</p>
              <div class="folder-selector">
                <input
                  type="text"
                  id="settingsDownloadPath"
                  class="form-control"
                  readonly
                  placeholder="Select output folder..."
                />
                <button id="selectOutputFolder" class="btn btn-secondary"><span>üìÅ</span> Browse</button>
              </div>
              <div class="folder-info"><small>Default: Downloads/KRA POST PORTUM TOOL</small></div>
            </div>

            <div class="settings-section">
              <h3>Output Format</h3>
              <p class="settings-description">Choose the file format for exports</p>
              <select id="settingsOutputFormat" class="form-control">
                <option value="xlsx">Excel (.xlsx)</option>
                <option value="csv">CSV (.csv)</option>
                <option value="json">JSON (.json)</option>
              </select>
            </div>

            <div class="settings-section">
              <h3>About</h3>
              <p class="settings-description">KRA POST PORTUM TOOL v1.0.0</p>
              <p class="settings-description">Professional KRA data extraction and audit tool</p>
            </div>
          </div>
          <div class="modal-footer">
            <button id="saveSettings" class="btn btn-primary"><span>üíæ</span> Save Settings</button>
            <button id="cancelSettings" class="btn btn-ghost">Cancel</button>
          </div>
        </div>
      </div>

      <!-- Main Content Area -->
      <main class="main-content">
        <!-- Page Header -->
        <header class="page-header">
          <div class="header-left">
            <h1 id="pageTitle">Company Setup</h1>
            <p class="page-description" id="pageDescription">Enter your KRA credentials to get started</p>
          </div>
          <div id="companyBadge" class="company-badge hidden">
            <div class="badge-content">
              <div class="badge-company-name" id="badgeCompanyName">Company</div>
              <div class="badge-company-pin" id="badgeCompanyPin">PIN: -</div>
            </div>
          </div>
        </header>

        <!-- Progress Section (TOP) -->
        <div id="progressSection" class="progress-section-top hidden">
          <div class="progress-card-top">
            <div class="progress-header">
              <h4 id="progressText">Processing...</h4>
              <span class="progress-percentage" id="progressPercentage">0%</span>
            </div>
            <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
            <div class="progress-log" id="progressLog"></div>
          </div>
        </div>

        <!-- Content Area -->
        <div class="content-area">
          <!-- Step 1: Company Setup -->
          <div id="company-setup" class="tab-content active">
            <div class="card">
              <div class="card-header"><h3>Enter Company Credentials</h3></div>
              <div class="card-body">
                <div class="form-grid">
                  <div class="form-group">
                    <label for="kraPin">KRA PIN</label>
                    <input type="text" id="kraPin" class="form-input" placeholder="e.g., P051766288C" required />
                  </div>

                  <div class="form-group">
                    <label for="kraPassword">Password</label>
                    <input type="password" id="kraPassword" class="form-input" placeholder="Enter password" required />
                  </div>
                </div>

                <div class="button-group">
                  <button id="fetchCompanyDetails" class="btn btn-primary">
                    <span class="btn-icon">üè¢</span> Get Company Details
                  </button>
                  <button id="validateCredentials" class="btn btn-secondary">
                    <span class="btn-icon">üîê</span> Validate Login
                  </button>
                </div>
              </div>
            </div>

            <div id="companyDetailsResult" class="card hidden">
              <div class="card-header"><h3>Company Information</h3></div>
              <div class="card-body">
                <div id="companyInfo" class="info-display"></div>
                <button id="confirmCompanyDetails" class="btn btn-success">
                  <span class="btn-icon">‚úì</span> Confirm & Continue
                </button>
              </div>
            </div>
          </div>

          <!-- Step 2: Password Validation -->
          <div id="password-validation" class="tab-content">
            <div class="card">
              <div class="card-header"><h3>Credential Validation</h3></div>
              <div class="card-body">
                <div class="stats-grid">
                  <div class="stat-card">
                    <div class="stat-label">Company</div>
                    <div id="validationCompanyName" class="stat-value">-</div>
                  </div>
                  <div class="stat-card">
                    <div class="stat-label">PIN</div>
                    <div id="validationPIN" class="stat-value">-</div>
                  </div>
                  <div class="stat-card">
                    <div class="stat-label">Status</div>
                    <div id="validationResult" class="stat-value">-</div>
                  </div>
                </div>

                <div class="button-group">
                  <button id="runPasswordValidation" class="btn btn-primary" disabled>
                    <span class="btn-icon">üîê</span> Run Validation
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Full Profile Tab (NEW) -->
          <div id="full-profile" class="tab-content">
            <div id="profileEmptyState" class="empty-state">
              <div class="empty-icon">üìä</div>
              <h3>No Data Available</h3>
              <p>Run extractions to see company profile data here</p>
              <button class="btn btn-primary" onclick="document.querySelector('[data-tab=&quot;company-setup&quot;]').click()">
                Start Setup
              </button>
            </div>

            <div id="profileDataView" class="profile-view hidden">
              <!-- Company Overview Card -->
              <div class="card profile-card">
                <div class="card-header">
                  <h3>Company Overview</h3>
                  <button id="refreshProfileBtn" class="btn btn-sm btn-ghost"><span>üîÑ</span> Refresh</button>
                </div>
                <div class="card-body">
                  <div class="profile-header">
                    <div class="profile-avatar"><span id="profileInitials">--</span></div>
                    <div class="profile-info">
                      <h2 id="profileCompanyName">Company Name</h2>
                      <p id="profilePin">PIN: -</p>
                      <div class="profile-badges">
                        <span id="profileVatStatus" class="badge badge-gray">VAT: Unknown</span>
                        <span id="profileEtimsStatus" class="badge badge-gray">eTIMS: Unknown</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Data Grid -->
              <div class="profile-grid">
                <!-- Manufacturer Details -->
                <div class="card" id="profileManufacturerCard">
                  <div class="card-header">
                    <h4>Business Details</h4>
                    <span class="status-dot status-pending"></span>
                  </div>
                  <div class="card-body">
                    <div id="profileManufacturerData" class="profile-data"><p class="empty-text">Not extracted</p></div>
                  </div>
                </div>

                <!-- Obligations -->
                <div class="card" id="profileObligationsCard">
                  <div class="card-header">
                    <h4>Tax Obligations</h4>
                    <span class="status-dot status-pending"></span>
                  </div>
                  <div class="card-body">
                    <div id="profileObligationsData" class="profile-data"><p class="empty-text">Not extracted</p></div>
                  </div>
                </div>

                <!-- Liabilities -->
                <div class="card" id="profileLiabilitiesCard">
                  <div class="card-header">
                    <h4>Liabilities Summary</h4>
                    <span class="status-dot status-pending"></span>
                  </div>
                  <div class="card-body">
                    <div id="profileLiabilitiesData" class="profile-data"><p class="empty-text">Not extracted</p></div>
                  </div>
                </div>

                <!-- VAT Returns -->
                <div class="card" id="profileVatCard">
                  <div class="card-header">
                    <h4>VAT Returns</h4>
                    <span class="status-dot status-pending"></span>
                  </div>
                  <div class="card-body">
                    <div id="profileVatData" class="profile-data"><p class="empty-text">Not extracted</p></div>
                  </div>
                </div>

                <!-- Agent Status -->
                <div class="card" id="profileAgentCard">
                  <div class="card-header">
                    <h4>Withholding Agent Status</h4>
                    <span class="status-dot status-pending"></span>
                  </div>
                  <div class="card-body">
                    <div id="profileAgentData" class="profile-data"><p class="empty-text">Not checked</p></div>
                  </div>
                </div>

                <!-- Director Details -->
                <div class="card" id="profileDirectorCard">
                  <div class="card-header">
                    <h4>Director Details</h4>
                    <span class="status-dot status-pending"></span>
                  </div>
                  <div class="card-body">
                    <div id="profileDirectorData" class="profile-data"><p class="empty-text">Not extracted</p></div>
                  </div>
                </div>

                <!-- Withholding VAT -->
                <div class="card" id="profileWhVatCard">
                  <div class="card-header">
                    <h4>Withholding VAT</h4>
                    <span class="status-dot status-pending"></span>
                  </div>
                  <div class="card-body">
                    <div id="profileWhVatData" class="profile-data"><p class="empty-text">Not extracted</p></div>
                  </div>
                </div>

                <!-- General Ledger -->
                <div class="card" id="profileLedgerCard">
                  <div class="card-header">
                    <h4>General Ledger</h4>
                    <span class="status-dot status-pending"></span>
                  </div>
                  <div class="card-body">
                    <div id="profileLedgerData" class="profile-data"><p class="empty-text">Not extracted</p></div>
                  </div>
                </div>

                <!-- TCC -->
                <div class="card" id="profileTccCard">
                  <div class="card-header">
                    <h4>Tax Compliance Certificate</h4>
                    <span class="status-dot status-pending"></span>
                  </div>
                  <div class="card-body">
                    <div id="profileTccData" class="profile-data"><p class="empty-text">Not downloaded</p></div>
                  </div>
                </div>

                <!-- Files -->
                <div class="card" id="profileFilesCard">
                  <div class="card-header">
                    <h4>Generated Files</h4>
                    <button id="openFilesFolder" class="btn btn-sm btn-ghost"><span>üìÅ</span> Open Folder</button>
                  </div>
                  <div class="card-body">
                    <div id="profileFilesData" class="profile-files"><p class="empty-text">No files generated</p></div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Other tabs (keeping structure minimal for now) -->
          <div id="manufacturer-details" class="tab-content">
            <div class="card">
              <div class="card-header"><h3>Manufacturer Details</h3></div>
              <div class="card-body">
                <div class="button-group">
                  <button id="fetchManufacturerDetails" class="btn btn-primary" disabled>
                    <span class="btn-icon">üìã</span> Fetch Details
                  </button>
                </div>
                <div id="manufacturerDetailsResult" class="result-section hidden"><div id="manufacturerInfo"></div></div>
              </div>
            </div>
          </div>

          <div id="director-details" class="tab-content">
            <div class="card">
              <div class="card-header"><h3>Director Details Extraction</h3></div>
              <div class="card-body">
                <div class="button-group">
                  <button id="runDirectorDetailsExtraction" class="btn btn-primary" disabled>
                    <span class="btn-icon">üëî</span> Extract Director Details
                  </button>
                </div>
                <div id="directorDetailsResults" class="result-section hidden"></div>
              </div>
            </div>
          </div>

          <div id="obligation-checker" class="tab-content">
            <div class="card">
              <div class="card-header"><h3>Obligation Checker</h3></div>
              <div class="card-body">
                <div class="button-group">
                  <button id="runObligationCheck" class="btn btn-primary" disabled>
                    <span class="btn-icon">üìù</span> Run Obligation Check
                  </button>
                </div>
                <div id="obligationResults" class="result-section hidden"></div>
              </div>
            </div>
          </div>

          <div id="agent-checker" class="tab-content">
            <div class="card">
              <div class="card-header"><h3>Withholding Agent Checker</h3></div>
              <div class="card-body">
                <div class="alert alert-info">
                  <p><strong>What this checks:</strong></p>
                  <ul>
                    <li>‚úì VAT Withholding Agent status</li>
                    <li>‚úì Rent Income Withholding Agent status</li>
                  </ul>
                </div>
                <div class="button-group">
                  <button id="runAgentCheck" class="btn btn-primary" disabled>
                    <span class="btn-icon">üîç</span> Check Agent Status
                  </button>
                </div>
                <div id="agentCheckResults" class="result-section hidden"></div>
              </div>
            </div>
          </div>

          <div id="liabilities" class="tab-content">
            <div class="card">
              <div class="card-header"><h3>Liabilities Extraction</h3></div>
              <div class="card-body">
                <div class="button-group">
                  <button id="runLiabilitiesExtraction" class="btn btn-primary" disabled>
                    <span class="btn-icon">üí∞</span> Extract Liabilities
                  </button>
                </div>
                <div id="liabilitiesResults" class="result-section hidden"></div>
              </div>
            </div>
          </div>

          <div id="vat-returns" class="tab-content">
            <div class="card">
              <div class="card-header"><h3>VAT Returns</h3></div>
              <div class="card-body">
                <div class="option-group">
                  <label class="radio-card">
                    <input type="radio" name="vatDateRange" value="all" checked />
                    <div class="radio-content"><strong>All Data</strong> <small>Extract everything available</small></div>
                  </label>

                  <label class="radio-card">
                    <input type="radio" name="vatDateRange" value="custom" />
                    <div class="radio-content"><strong>Custom Range</strong> <small>Specify date range</small></div>
                  </label>
                </div>

                <div id="vatCustomDateInputs" class="custom-date-inputs hidden">
                  <div class="date-row">
                    <div class="form-group">
                      <label>From</label>
                      <div class="date-group">
                        <select id="vatStartMonth" class="form-input">
                          <option value="1">Jan</option>
                          <option value="2">Feb</option>
                          <option value="3">Mar</option>
                          <option value="4">Apr</option>
                          <option value="5">May</option>
                          <option value="6">Jun</option>
                          <option value="7">Jul</option>
                          <option value="8">Aug</option>
                          <option value="9">Sep</option>
                          <option value="10">Oct</option>
                          <option value="11">Nov</option>
                          <option value="12">Dec</option>
                        </select>
                        <input type="number" id="vatStartYear" class="form-input" min="2010" max="2030" value="2024" />
                      </div>
                    </div>
                    <div class="form-group">
                      <label>To</label>
                      <div class="date-group">
                        <select id="vatEndMonth" class="form-input">
                          <option value="1">Jan</option>
                          <option value="2">Feb</option>
                          <option value="3">Mar</option>
                          <option value="4">Apr</option>
                          <option value="5">May</option>
                          <option value="6">Jun</option>
                          <option value="7">Jul</option>
                          <option value="8">Aug</option>
                          <option value="9">Sep</option>
                          <option value="10">Oct</option>
                          <option value="11">Nov</option>
                          <option value="12" selected>Dec</option>
                        </select>
                        <input type="number" id="vatEndYear" class="form-input" min="2010" max="2030" value="2024" />
                      </div>
                    </div>
                  </div>
                </div>

                <div class="button-group">
                  <button id="runVATExtraction" class="btn btn-primary" disabled>
                    <span class="btn-icon">üìä</span> Extract VAT Data
                  </button>
                </div>

                <div id="vatResults" class="result-section hidden"></div>
              </div>
            </div>
          </div>

          <!-- WH VAT Returns Tab -->
          <div id="wh-vat-returns" class="tab-content">
            <div class="card">
              <div class="card-header"><h3>Withholding VAT Returns</h3></div>
              <div class="card-body">
                <div class="option-group">
                  <label class="radio-card">
                    <input type="radio" name="whVatDateRange" value="all" checked />
                    <div class="radio-content"><strong>All Data</strong> <small>Extract everything available</small></div>
                  </label>

                  <label class="radio-card">
                    <input type="radio" name="whVatDateRange" value="custom" />
                    <div class="radio-content"><strong>Custom Range</strong> <small>Specify date range</small></div>
                  </label>
                </div>

                <div id="whVatCustomDateInputs" class="custom-date-inputs hidden">
                  <div class="date-row">
                    <div class="form-group">
                      <label>From</label>
                      <div class="date-group">
                        <select id="whVatStartMonth" class="form-input">
                          <option value="1" selected>Jan</option>
                          <option value="2">Feb</option>
                          <option value="3">Mar</option>
                          <option value="4">Apr</option>
                          <option value="5">May</option>
                          <option value="6">Jun</option>
                          <option value="7">Jul</option>
                          <option value="8">Aug</option>
                          <option value="9">Sep</option>
                          <option value="10">Oct</option>
                          <option value="11">Nov</option>
                          <option value="12">Dec</option>
                        </select>
                        <input
                          type="number"
                          id="whVatStartYear"
                          class="form-input"
                          min="2010"
                          max="2030"
                          value="2025"
                          placeholder="2025"
                        />
                      </div>
                    </div>
                    <div class="form-group">
                      <label>To</label>
                      <div class="date-group">
                        <select id="whVatEndMonth" class="form-input">
                          <option value="1">Jan</option>
                          <option value="2">Feb</option>
                          <option value="3">Mar</option>
                          <option value="4">Apr</option>
                          <option value="5">May</option>
                          <option value="6">Jun</option>
                          <option value="7">Jul</option>
                          <option value="8">Aug</option>
                          <option value="9">Sep</option>
                          <option value="10">Oct</option>
                          <option value="11">Nov</option>
                          <option value="12" selected>Dec</option>
                        </select>
                        <input
                          type="number"
                          id="whVatEndYear"
                          class="form-input"
                          min="2010"
                          max="2030"
                          value="2025"
                          placeholder="2025"
                        />
                      </div>
                    </div>
                  </div>
                </div>

                <div class="button-group">
                  <button id="runWhVATExtraction" class="btn btn-primary" disabled>
                    <span class="btn-icon">üßæ</span> Extract WH VAT Data
                  </button>
                </div>

                <div id="whVatResults" class="result-section hidden"></div>
              </div>
            </div>
          </div>

          <div id="general-ledger" class="tab-content">
            <div class="card">
              <div class="card-header"><h3>General Ledger</h3></div>
              <div class="card-body">
                <div class="button-group">
                  <button id="runLedgerExtraction" class="btn btn-primary" disabled>
                    <span class="btn-icon">üìñ</span> Extract Ledger
                  </button>
                </div>
                <div id="ledgerResults" class="result-section hidden"></div>
              </div>
            </div>
          </div>

          <div id="tax-compliance" class="tab-content">
            <div class="card">
              <div class="card-header"><h3>Tax Compliance Certificate Downloader</h3></div>
              <div class="card-body">
                <div class="button-group">
                  <button id="runTCCDownloader" class="btn btn-primary" disabled>
                    <span class="btn-icon">‚úÖ</span> Download TCC
                  </button>
                </div>
                <div id="tccResults" class="result-section hidden"></div>
              </div>
            </div>
          </div>

          <div id="all-automations" class="tab-content">
            <div class="card">
              <div class="card-header"><h3>Run All Automations</h3></div>
              <div class="card-body">
                <!-- Credentials Display Section -->
                <div class="credentials-display">
                  <h4>üìã Current Credentials</h4>
                  <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                    <div class="form-group">
                      <label for="runAllPinDisplay">KRA PIN</label>
                      <input type="text" id="runAllPinDisplay" class="form-control" readonly />
                    </div>
                    <div class="form-group">
                      <label for="runAllPasswordDisplay">Password</label>
                      <input type="password" id="runAllPasswordDisplay" class="form-control" readonly />
                    </div>
                    <div class="form-group">
                      <label for="runAllCompanyDisplay">Company Name</label>
                      <input type="text" id="runAllCompanyDisplay" class="form-control" readonly />
                    </div>
                  </div>
                </div>

                <div class="automation-table-container">
                  <table class="automation-table">
                    <thead>
                      <tr>
                        <th style="width: 50px;"><input type="checkbox" id="selectAllAutomations" checked /></th>
                        <th style="width: 50px;"></th>
                        <th style="width: 200px;">Automation</th>
                        <th>Description</th>
                        <th style="width: 360px;">Date Range</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td><input type="checkbox" class="automation-checkbox" id="includePasswordValidation" checked /></td>
                        <td>üîê</td>
                        <td><strong>Password Validation</strong></td>
                        <td>Validate KRA credentials</td>
                        <td><span class="date-na">N/A</span></td>
                      </tr>
                      <tr>
                        <td><input type="checkbox" class="automation-checkbox" id="includeManufacturerDetails" checked /></td>
                        <td>üìã</td>
                        <td><strong>Manufacturer Details</strong></td>
                        <td>Fetch company information</td>
                        <td><span class="date-na">N/A</span></td>
                      </tr>
                      <tr>
                        <td><input type="checkbox" class="automation-checkbox" id="includeAgentStatus" checked /></td>
                        <td>üë§</td>
                        <td><strong>Agent Status Check</strong></td>
                        <td>Check withholding agent status</td>
                        <td><span class="date-na">N/A</span></td>
                      </tr>
                      <tr>
                        <td><input type="checkbox" class="automation-checkbox" id="includeObligationCheck" checked /></td>
                        <td>üìù</td>
                        <td><strong>Obligation Check</strong></td>
                        <td>Check tax obligations</td>
                        <td><span class="date-na">N/A</span></td>
                      </tr>
                      <tr>
                        <td><input type="checkbox" class="automation-checkbox" id="includeDirectorDetails" checked /></td>
                        <td>üë•</td>
                        <td><strong>Director Details</strong></td>
                        <td>Extract director information</td>
                        <td><span class="date-na">N/A</span></td>
                      </tr>
                      <tr>
                        <td><input type="checkbox" class="automation-checkbox" id="includeVATReturns" checked /></td>
                        <td>üìä</td>
                        <td><strong>VAT Returns</strong></td>
                        <td>Extract VAT returns data</td>
                        <td>
                          <div class="date-range-inputs">
                            <select class="form-control-sm" id="vatRangeType">
                              <option value="all">All Data</option>
                              <option value="custom">Custom</option>
                            </select>
                            <div class="custom-range hidden" id="vatCustomRange">
                              <input
                                type="number"
                                class="form-control-xs"
                                placeholder="M"
                                min="1"
                                max="12"
                                id="vatStartMonth"
                              />
                              <input
                                type="number"
                                class="form-control-xs"
                                placeholder="YYYY"
                                min="2000"
                                max="2099"
                                id="vatStartYear"
                              />
                              <span>to</span>
                              <input type="number" class="form-control-xs" placeholder="M" min="1" max="12" id="vatEndMonth" />
                              <input
                                type="number"
                                class="form-control-xs"
                                placeholder="YYYY"
                                min="2000"
                                max="2099"
                                id="vatEndYear"
                              />
                            </div>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td><input type="checkbox" class="automation-checkbox" id="includeWhVatReturns" checked /></td>
                        <td>üìà</td>
                        <td><strong>WH VAT Returns</strong></td>
                        <td>Withholding VAT data</td>
                        <td>
                          <div class="date-range-inputs">
                            <select class="form-control-sm" id="whVatRangeType">
                              <option value="all">All Data</option>
                              <option value="custom">Custom</option>
                            </select>
                            <div class="custom-range hidden" id="whVatCustomRange">
                              <input
                                type="number"
                                class="form-control-xs"
                                placeholder="M"
                                min="1"
                                max="12"
                                id="whVatStartMonth"
                              />
                              <input
                                type="number"
                                class="form-control-xs"
                                placeholder="YYYY"
                                min="2000"
                                max="2099"
                                id="whVatStartYear"
                              />
                              <span>to</span>
                              <input
                                type="number"
                                class="form-control-xs"
                                placeholder="M"
                                min="1"
                                max="12"
                                id="whVatEndMonth"
                              />
                              <input
                                type="number"
                                class="form-control-xs"
                                placeholder="YYYY"
                                min="2000"
                                max="2099"
                                id="whVatEndYear"
                              />
                            </div>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td><input type="checkbox" class="automation-checkbox" id="includeGeneralLedger" checked /></td>
                        <td>üìñ</td>
                        <td><strong>General Ledger</strong></td>
                        <td>Extract transaction ledger</td>
                        <td><span class="date-na">N/A</span></td>
                      </tr>
                      <tr>
                        <td><input type="checkbox" class="automation-checkbox" id="includeTaxCompliance" checked /></td>
                        <td>üìú</td>
                        <td><strong>Tax Compliance Certificate</strong></td>
                        <td>Download TCC certificate</td>
                        <td><span class="date-na">N/A</span></td>
                      </tr>
                      <tr>
                        <td><input type="checkbox" class="automation-checkbox" id="includeLiabilities" checked /></td>
                        <td>üí∞</td>
                        <td><strong>Liabilities</strong></td>
                        <td>Extract liabilities data</td>
                        <td><span class="date-na">N/A</span></td>
                      </tr>
                    </tbody>
                  </table>
                </div>

                <div class="button-group" style="margin-top: 20px;">
                  <button id="runAllAutomations" class="btn btn-primary btn-lg" disabled>
                    <span class="btn-icon">‚ö°</span> Run Selected Automations
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Global Progress Section -->
        <div id="progressSection" class="progress-section hidden">
          <div class="progress-card">
            <div class="progress-header">
              <h4>Processing...</h4>
              <span id="progressPercentage" class="progress-percentage">0%</span>
            </div>
            <div class="progress-bar"><div id="progressFill" class="progress-fill"></div></div>
            <div id="progressText" class="progress-text">Initializing...</div>
            <div id="progressLog" class="progress-log"></div>
          </div>
        </div>
      </main>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal hidden">
      <div class="modal-overlay"></div>
      <div class="modal-content">
        <div class="modal-header">
          <h3>Settings</h3>
          <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="downloadPath">Download Folder</label>
            <div class="path-selector">
              <input type="text" id="downloadPath" class="form-input" readonly placeholder="Select folder..." />
              <button type="button" id="selectFolder" class="btn btn-secondary"><span>üìÅ</span> Browse</button>
            </div>
          </div>
          <div class="form-group">
            <label for="outputFormat">Output Format</label>
            <select id="outputFormat" class="form-input">
              <option value="individual">Individual Files</option>
              <option value="combined">Combined Report</option>
            </select>
          </div>
        </div>
        <div class="modal-footer">
          <button id="saveConfig" class="btn btn-primary">Save Settings</button>
          <button id="closeModal" class="btn btn-secondary">Cancel</button>
        </div>
      </div>
    </div>

    <script src="renderer-new.js"></script>
  </body>
</html>
